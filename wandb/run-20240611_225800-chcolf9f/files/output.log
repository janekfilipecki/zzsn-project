06/11/2024 22:58:03 - INFO - __main__ - ***** Running training *****
06/11/2024 22:58:03 - INFO - __main__ -   Num examples = 7
06/11/2024 22:58:03 - INFO - __main__ -   Num batches each epoch = 7
06/11/2024 22:58:03 - INFO - __main__ -   Num Epochs = 143
06/11/2024 22:58:03 - INFO - __main__ -   Instantaneous batch size per device = 1
06/11/2024 22:58:03 - INFO - __main__ -   Total train batch size (w. parallel, distributed & accumulation) = 1
06/11/2024 22:58:03 - INFO - __main__ -   Gradient Accumulation steps = 1
06/11/2024 22:58:03 - INFO - __main__ -   Total optimization steps = 1000




Steps:   1%|          | 7/1000 [00:11<23:34,  1.42s/it, loss=0.275, lr=5e-5]06/11/2024 22:58:15 - INFO - __main__ - Running validation...
 Generating 4 images with prompt: a hat in the crt style.
{'feature_extractor', 'image_encoder'} was not found in config. Values will be initialized to default values.
                                                                     Loaded tokenizer_2 as CLIPTokenizer from `tokenizer_2` subfolder of stabilityai/stable-diffusion-xl-base-1.0.
{'sigma_max', 'timestep_type', 'sigma_min'} was not found in config. Values will be initialized to default values.
Loaded scheduler as EulerDiscreteScheduler from `scheduler` subfolder of stabilityai/stable-diffusion-xl-base-1.0.
Loaded tokenizer as CLIPTokenizer from `tokenizer` subfolder of stabilityai/stable-diffusion-xl-base-1.0.
Loading pipeline components...: 100%|██████████| 7/7 [00:00<00:00, 59.70it/s]
{'lambda_min_clipped', 'use_lu_lambdas', 'euler_at_final', 'variance_type', 'algorithm_type', 'thresholding', 'lower_order_final', 'dynamic_thresholding_ratio', 'solver_order', 'solver_type'} was not found in config. Values will be initialized to default values.
/net/tscratch/people/plgas2000/.conda/envs/myenv2/lib/python3.9/site-packages/torch/utils/checkpoint.py:90: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

































































































































































































































































Steps:  36%|███▌      | 357/1000 [09:34<18:50,  1.76s/it, loss=0.0153, lr=5e-5] 06/11/2024 23:07:38 - INFO - __main__ - Running validation...
 Generating 4 images with prompt: a hat in the crt style.
{'feature_extractor', 'image_encoder'} was not found in config. Values will be initialized to default values.
                                                                     Loaded tokenizer_2 as CLIPTokenizer from `tokenizer_2` subfolder of stabilityai/stable-diffusion-xl-base-1.0.
{'sigma_max', 'timestep_type', 'sigma_min'} was not found in config. Values will be initialized to default values.
Loaded scheduler as EulerDiscreteScheduler from `scheduler` subfolder of stabilityai/stable-diffusion-xl-base-1.0.
Loaded tokenizer as CLIPTokenizer from `tokenizer` subfolder of stabilityai/stable-diffusion-xl-base-1.0.
Loading pipeline components...: 100%|██████████| 7/7 [00:00<00:00, 48.91it/s]
{'lambda_min_clipped', 'use_lu_lambdas', 'euler_at_final', 'variance_type', 'algorithm_type', 'thresholding', 'lower_order_final', 'dynamic_thresholding_ratio', 'solver_order', 'solver_type'} was not found in config. Values will be initialized to default values.



























































































































Steps:  50%|█████     | 500/1000 [14:31<14:15,  1.71s/it, loss=0.307, lr=5e-5]06/11/2024 23:12:35 - INFO - accelerate.accelerator - Saving current state to ./models/dreambooth_lora_sdxl_style3_sketch_r32_2024-06-11_22-57-19/checkpoint-500
Model weights saved in ./models/dreambooth_lora_sdxl_style3_sketch_r32_2024-06-11_22-57-19/checkpoint-500/pytorch_lora_weights.safetensors
06/11/2024 23:12:36 - INFO - accelerate.checkpointing - Optimizer state saved in models/dreambooth_lora_sdxl_style3_sketch_r32_2024-06-11_22-57-19/checkpoint-500/optimizer.bin
06/11/2024 23:12:36 - INFO - accelerate.checkpointing - Scheduler state saved in models/dreambooth_lora_sdxl_style3_sketch_r32_2024-06-11_22-57-19/checkpoint-500/scheduler.bin
06/11/2024 23:12:36 - INFO - accelerate.checkpointing - Sampler state for dataloader 0 saved in models/dreambooth_lora_sdxl_style3_sketch_r32_2024-06-11_22-57-19/checkpoint-500/sampler.bin
06/11/2024 23:12:36 - INFO - accelerate.checkpointing - Gradient scaler state saved in models/dreambooth_lora_sdxl_style3_sketch_r32_2024-06-11_22-57-19/checkpoint-500/scaler.pt
06/11/2024 23:12:36 - INFO - accelerate.checkpointing - Random states saved in models/dreambooth_lora_sdxl_style3_sketch_r32_2024-06-11_22-57-19/checkpoint-500/random_states_0.pkl
06/11/2024 23:12:36 - INFO - __main__ - Saved state to ./models/dreambooth_lora_sdxl_style3_sketch_r32_2024-06-11_22-57-19/checkpoint-500
















































































































































































Steps:  71%|███████   | 707/1000 [20:29<07:00,  1.44s/it, loss=0.286, lr=5e-5]06/11/2024 23:18:33 - INFO - __main__ - Running validation...
 Generating 4 images with prompt: a hat in the crt style.
{'feature_extractor', 'image_encoder'} was not found in config. Values will be initialized to default values.
                                                                     Loaded tokenizer_2 as CLIPTokenizer from `tokenizer_2` subfolder of stabilityai/stable-diffusion-xl-base-1.0.
{'sigma_max', 'timestep_type', 'sigma_min'} was not found in config. Values will be initialized to default values.
Loaded scheduler as EulerDiscreteScheduler from `scheduler` subfolder of stabilityai/stable-diffusion-xl-base-1.0.
Loaded tokenizer as CLIPTokenizer from `tokenizer` subfolder of stabilityai/stable-diffusion-xl-base-1.0.
Loading pipeline components...: 100%|██████████| 7/7 [00:00<00:00, 58.50it/s]
{'lambda_min_clipped', 'use_lu_lambdas', 'euler_at_final', 'variance_type', 'algorithm_type', 'thresholding', 'lower_order_final', 'dynamic_thresholding_ratio', 'solver_order', 'solver_type'} was not found in config. Values will be initialized to default values.
































































































































































































































































Steps: 100%|██████████| 1000/1000 [30:06<00:00,  1.61s/it, loss=0.00257, lr=5e-5]06/11/2024 23:28:10 - INFO - accelerate.accelerator - Saving current state to ./models/dreambooth_lora_sdxl_style3_sketch_r32_2024-06-11_22-57-19/checkpoint-1000
Model weights saved in ./models/dreambooth_lora_sdxl_style3_sketch_r32_2024-06-11_22-57-19/checkpoint-1000/pytorch_lora_weights.safetensors
06/11/2024 23:28:11 - INFO - accelerate.checkpointing - Optimizer state saved in models/dreambooth_lora_sdxl_style3_sketch_r32_2024-06-11_22-57-19/checkpoint-1000/optimizer.bin
06/11/2024 23:28:11 - INFO - accelerate.checkpointing - Scheduler state saved in models/dreambooth_lora_sdxl_style3_sketch_r32_2024-06-11_22-57-19/checkpoint-1000/scheduler.bin
06/11/2024 23:28:11 - INFO - accelerate.checkpointing - Sampler state for dataloader 0 saved in models/dreambooth_lora_sdxl_style3_sketch_r32_2024-06-11_22-57-19/checkpoint-1000/sampler.bin
06/11/2024 23:28:11 - INFO - accelerate.checkpointing - Gradient scaler state saved in models/dreambooth_lora_sdxl_style3_sketch_r32_2024-06-11_22-57-19/checkpoint-1000/scaler.pt
06/11/2024 23:28:11 - INFO - accelerate.checkpointing - Random states saved in models/dreambooth_lora_sdxl_style3_sketch_r32_2024-06-11_22-57-19/checkpoint-1000/random_states_0.pkl
06/11/2024 23:28:11 - INFO - __main__ - Saved state to ./models/dreambooth_lora_sdxl_style3_sketch_r32_2024-06-11_22-57-19/checkpoint-1000
Steps: 100%|██████████| 1000/1000 [30:07<00:00,  1.61s/it, loss=0.211, lr=5e-5]  Model weights saved in ./models/dreambooth_lora_sdxl_style3_sketch_r32_2024-06-11_22-57-19/pytorch_lora_weights.safetensors
{'feature_extractor', 'image_encoder'} was not found in config. Values will be initialized to default values.
                                                                     Loaded tokenizer_2 as CLIPTokenizer from `tokenizer_2` subfolder of stabilityai/stable-diffusion-xl-base-1.0.
{'sigma_max', 'timestep_type', 'sigma_min'} was not found in config. Values will be initialized to default values.
Loaded scheduler as EulerDiscreteScheduler from `scheduler` subfolder of stabilityai/stable-diffusion-xl-base-1.0.
{'dropout', 'attention_type', 'reverse_transformer_layers_per_block'} was not found in config. Values will be initialized to default values.
Loaded unet as UNet2DConditionModel from `unet` subfolder of stabilityai/stable-diffusion-xl-base-1.0.
                                                                             Loaded tokenizer as CLIPTokenizer from `tokenizer` subfolder of stabilityai/stable-diffusion-xl-base-1.0.
Loaded text_encoder as CLIPTextModel from `text_encoder` subfolder of stabilityai/stable-diffusion-xl-base-1.0.
Loading pipeline components...: 100%|██████████| 7/7 [00:14<00:00,  2.02s/it]
{'lambda_min_clipped', 'use_lu_lambdas', 'euler_at_final', 'variance_type', 'algorithm_type', 'thresholding', 'lower_order_final', 'dynamic_thresholding_ratio', 'solver_order', 'solver_type'} was not found in config. Values will be initialized to default values.
Loading unet.
Loading text_encoder.
/net/tscratch/people/plgas2000/.conda/envs/myenv2/lib/python3.9/site-packages/diffusers/loaders/lora.py:708: FutureWarning: `_modify_text_encoder` is deprecated and will be removed in version 0.25. You are using an old version of LoRA backend. This will be deprecated in the next releases in favor of PEFT make sure to install the latest PEFT and transformers packages in the future.
  deprecate("_modify_text_encoder", "0.25", LORA_DEPRECATION_MESSAGE)
/net/tscratch/people/plgas2000/.conda/envs/myenv2/lib/python3.9/site-packages/diffusers/loaders/lora.py:679: FutureWarning: `_remove_text_encoder_monkey_patch_classmethod` is deprecated and will be removed in version 0.25. You are using an old version of LoRA backend. This will be deprecated in the next releases in favor of PEFT make sure to install the latest PEFT and transformers packages in the future.
  deprecate("_remove_text_encoder_monkey_patch_classmethod", "0.25", LORA_DEPRECATION_MESSAGE)
Loading text_encoder_2.

100%|██████████| 25/25 [00:03<00:00,  7.91it/s]

100%|██████████| 25/25 [00:03<00:00,  7.16it/s]

100%|██████████| 25/25 [00:03<00:00,  8.25it/s]

100%|██████████| 25/25 [00:03<00:00,  8.24it/s]