06/11/2024 14:32:56 - INFO - __main__ - ***** Running training *****
06/11/2024 14:32:56 - INFO - __main__ -   Num examples = 7
06/11/2024 14:32:56 - INFO - __main__ -   Num batches each epoch = 7
06/11/2024 14:32:56 - INFO - __main__ -   Num Epochs = 143
06/11/2024 14:32:56 - INFO - __main__ -   Instantaneous batch size per device = 1
06/11/2024 14:32:56 - INFO - __main__ -   Total train batch size (w. parallel, distributed & accumulation) = 1
06/11/2024 14:32:56 - INFO - __main__ -   Gradient Accumulation steps = 1
06/11/2024 14:32:56 - INFO - __main__ -   Total optimization steps = 1000




Steps:   1%|          | 7/1000 [00:11<24:30,  1.48s/it, loss=0.275, lr=5e-5]06/11/2024 14:33:08 - INFO - __main__ - Running validation...
 Generating 4 images with prompt: a hat in the crt style.
{'feature_extractor', 'image_encoder'} was not found in config. Values will be initialized to default values.
                                                                     {'sigma_max', 'timestep_type', 'sigma_min'} was not found in config. Values will be initialized to default values.
Loaded scheduler as EulerDiscreteScheduler from `scheduler` subfolder of stabilityai/stable-diffusion-xl-base-1.0.
Loaded tokenizer as CLIPTokenizer from `tokenizer` subfolder of stabilityai/stable-diffusion-xl-base-1.0.
Loaded tokenizer_2 as CLIPTokenizer from `tokenizer_2` subfolder of stabilityai/stable-diffusion-xl-base-1.0.
Loading pipeline components...: 100%|██████████| 7/7 [00:00<00:00, 57.43it/s]
{'algorithm_type', 'lower_order_final', 'euler_at_final', 'solver_type', 'solver_order', 'lambda_min_clipped', 'use_lu_lambdas', 'variance_type', 'dynamic_thresholding_ratio', 'thresholding'} was not found in config. Values will be initialized to default values.
/net/tscratch/people/plgas2000/.conda/envs/myenv2/lib/python3.9/site-packages/torch/utils/checkpoint.py:90: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(





















































































































































































































































Steps:  36%|███▌      | 357/1000 [09:10<15:24,  1.44s/it, loss=0.0153, lr=5e-5] 06/11/2024 14:42:07 - INFO - __main__ - Running validation...
 Generating 4 images with prompt: a hat in the crt style.
{'feature_extractor', 'image_encoder'} was not found in config. Values will be initialized to default values.
                                                                     {'sigma_max', 'timestep_type', 'sigma_min'} was not found in config. Values will be initialized to default values.
Loaded scheduler as EulerDiscreteScheduler from `scheduler` subfolder of stabilityai/stable-diffusion-xl-base-1.0.
Loaded tokenizer as CLIPTokenizer from `tokenizer` subfolder of stabilityai/stable-diffusion-xl-base-1.0.
Loaded tokenizer_2 as CLIPTokenizer from `tokenizer_2` subfolder of stabilityai/stable-diffusion-xl-base-1.0.
Loading pipeline components...: 100%|██████████| 7/7 [00:00<00:00, 60.49it/s]
{'algorithm_type', 'lower_order_final', 'euler_at_final', 'solver_type', 'solver_order', 'lambda_min_clipped', 'use_lu_lambdas', 'variance_type', 'dynamic_thresholding_ratio', 'thresholding'} was not found in config. Values will be initialized to default values.







































































































Steps:  50%|█████     | 500/1000 [13:23<12:22,  1.48s/it, loss=0.307, lr=5e-5]06/11/2024 14:46:20 - INFO - accelerate.accelerator - Saving current state to ./models/dreambooth_lora_sdxl_style3_sketch_rank32_2024-06-11_14-32-10/checkpoint-500
Model weights saved in ./models/dreambooth_lora_sdxl_style3_sketch_rank32_2024-06-11_14-32-10/checkpoint-500/pytorch_lora_weights.safetensors
06/11/2024 14:46:21 - INFO - accelerate.checkpointing - Optimizer state saved in models/dreambooth_lora_sdxl_style3_sketch_rank32_2024-06-11_14-32-10/checkpoint-500/optimizer.bin
06/11/2024 14:46:21 - INFO - accelerate.checkpointing - Scheduler state saved in models/dreambooth_lora_sdxl_style3_sketch_rank32_2024-06-11_14-32-10/checkpoint-500/scheduler.bin
06/11/2024 14:46:21 - INFO - accelerate.checkpointing - Sampler state for dataloader 0 saved in models/dreambooth_lora_sdxl_style3_sketch_rank32_2024-06-11_14-32-10/checkpoint-500/sampler.bin
06/11/2024 14:46:21 - INFO - accelerate.checkpointing - Gradient scaler state saved in models/dreambooth_lora_sdxl_style3_sketch_rank32_2024-06-11_14-32-10/checkpoint-500/scaler.pt
06/11/2024 14:46:21 - INFO - accelerate.checkpointing - Random states saved in models/dreambooth_lora_sdxl_style3_sketch_rank32_2024-06-11_14-32-10/checkpoint-500/random_states_0.pkl
06/11/2024 14:46:21 - INFO - __main__ - Saved state to ./models/dreambooth_lora_sdxl_style3_sketch_rank32_2024-06-11_14-32-10/checkpoint-500























































































































































Steps:  71%|███████   | 707/1000 [18:30<07:03,  1.44s/it, loss=0.286, lr=5e-5]06/11/2024 14:51:27 - INFO - __main__ - Running validation...
 Generating 4 images with prompt: a hat in the crt style.
{'feature_extractor', 'image_encoder'} was not found in config. Values will be initialized to default values.
                                                                     {'sigma_max', 'timestep_type', 'sigma_min'} was not found in config. Values will be initialized to default values.
Loaded scheduler as EulerDiscreteScheduler from `scheduler` subfolder of stabilityai/stable-diffusion-xl-base-1.0.
Loaded tokenizer as CLIPTokenizer from `tokenizer` subfolder of stabilityai/stable-diffusion-xl-base-1.0.
Loaded tokenizer_2 as CLIPTokenizer from `tokenizer_2` subfolder of stabilityai/stable-diffusion-xl-base-1.0.
Loading pipeline components...: 100%|██████████| 7/7 [00:00<00:00, 56.55it/s]
{'algorithm_type', 'lower_order_final', 'euler_at_final', 'solver_type', 'solver_order', 'lambda_min_clipped', 'use_lu_lambdas', 'variance_type', 'dynamic_thresholding_ratio', 'thresholding'} was not found in config. Values will be initialized to default values.



















































































































































































































Steps: 100%|██████████| 1000/1000 [26:19<00:00,  1.46s/it, loss=0.00257, lr=5e-5]06/11/2024 14:59:16 - INFO - accelerate.accelerator - Saving current state to ./models/dreambooth_lora_sdxl_style3_sketch_rank32_2024-06-11_14-32-10/checkpoint-1000
Model weights saved in ./models/dreambooth_lora_sdxl_style3_sketch_rank32_2024-06-11_14-32-10/checkpoint-1000/pytorch_lora_weights.safetensors
06/11/2024 14:59:17 - INFO - accelerate.checkpointing - Optimizer state saved in models/dreambooth_lora_sdxl_style3_sketch_rank32_2024-06-11_14-32-10/checkpoint-1000/optimizer.bin
06/11/2024 14:59:17 - INFO - accelerate.checkpointing - Scheduler state saved in models/dreambooth_lora_sdxl_style3_sketch_rank32_2024-06-11_14-32-10/checkpoint-1000/scheduler.bin
06/11/2024 14:59:17 - INFO - accelerate.checkpointing - Sampler state for dataloader 0 saved in models/dreambooth_lora_sdxl_style3_sketch_rank32_2024-06-11_14-32-10/checkpoint-1000/sampler.bin
06/11/2024 14:59:17 - INFO - accelerate.checkpointing - Gradient scaler state saved in models/dreambooth_lora_sdxl_style3_sketch_rank32_2024-06-11_14-32-10/checkpoint-1000/scaler.pt
06/11/2024 14:59:17 - INFO - accelerate.checkpointing - Random states saved in models/dreambooth_lora_sdxl_style3_sketch_rank32_2024-06-11_14-32-10/checkpoint-1000/random_states_0.pkl
06/11/2024 14:59:17 - INFO - __main__ - Saved state to ./models/dreambooth_lora_sdxl_style3_sketch_rank32_2024-06-11_14-32-10/checkpoint-1000
Steps: 100%|██████████| 1000/1000 [26:20<00:00,  1.46s/it, loss=0.211, lr=5e-5]  Model weights saved in ./models/dreambooth_lora_sdxl_style3_sketch_rank32_2024-06-11_14-32-10/pytorch_lora_weights.safetensors
{'feature_extractor', 'image_encoder'} was not found in config. Values will be initialized to default values.
                                                                     {'sigma_max', 'timestep_type', 'sigma_min'} was not found in config. Values will be initialized to default values.
Loaded scheduler as EulerDiscreteScheduler from `scheduler` subfolder of stabilityai/stable-diffusion-xl-base-1.0.
Loaded text_encoder as CLIPTextModel from `text_encoder` subfolder of stabilityai/stable-diffusion-xl-base-1.0.
                                                                             Loaded tokenizer as CLIPTokenizer from `tokenizer` subfolder of stabilityai/stable-diffusion-xl-base-1.0.
Loaded tokenizer_2 as CLIPTokenizer from `tokenizer_2` subfolder of stabilityai/stable-diffusion-xl-base-1.0.
                                                                             {'attention_type', 'dropout', 'reverse_transformer_layers_per_block'} was not found in config. Values will be initialized to default values.

Loaded unet as UNet2DConditionModel from `unet` subfolder of stabilityai/stable-diffusion-xl-base-1.0.
Loaded text_encoder_2 as CLIPTextModelWithProjection from `text_encoder_2` subfolder of stabilityai/stable-diffusion-xl-base-1.0.
Loading pipeline components...: 100%|██████████| 7/7 [00:11<00:00,  1.65s/it]
{'algorithm_type', 'lower_order_final', 'euler_at_final', 'solver_type', 'solver_order', 'lambda_min_clipped', 'use_lu_lambdas', 'variance_type', 'dynamic_thresholding_ratio', 'thresholding'} was not found in config. Values will be initialized to default values.
Loading unet.
Loading text_encoder.
/net/tscratch/people/plgas2000/.conda/envs/myenv2/lib/python3.9/site-packages/diffusers/loaders/lora.py:708: FutureWarning: `_modify_text_encoder` is deprecated and will be removed in version 0.25. You are using an old version of LoRA backend. This will be deprecated in the next releases in favor of PEFT make sure to install the latest PEFT and transformers packages in the future.
  deprecate("_modify_text_encoder", "0.25", LORA_DEPRECATION_MESSAGE)
/net/tscratch/people/plgas2000/.conda/envs/myenv2/lib/python3.9/site-packages/diffusers/loaders/lora.py:679: FutureWarning: `_remove_text_encoder_monkey_patch_classmethod` is deprecated and will be removed in version 0.25. You are using an old version of LoRA backend. This will be deprecated in the next releases in favor of PEFT make sure to install the latest PEFT and transformers packages in the future.
  deprecate("_remove_text_encoder_monkey_patch_classmethod", "0.25", LORA_DEPRECATION_MESSAGE)
Loading text_encoder_2.

100%|██████████| 25/25 [00:03<00:00,  8.23it/s]
100%|██████████| 25/25 [00:03<00:00,  8.19it/s]

100%|██████████| 25/25 [00:03<00:00,  6.97it/s]


100%|██████████| 25/25 [00:03<00:00,  8.18it/s]