06/12/2024 02:11:40 - INFO - __main__ - ***** Running training *****
06/12/2024 02:11:40 - INFO - __main__ -   Num examples = 7
06/12/2024 02:11:40 - INFO - __main__ -   Num batches each epoch = 7
06/12/2024 02:11:40 - INFO - __main__ -   Num Epochs = 143
06/12/2024 02:11:40 - INFO - __main__ -   Instantaneous batch size per device = 1
06/12/2024 02:11:40 - INFO - __main__ -   Total train batch size (w. parallel, distributed & accumulation) = 1
06/12/2024 02:11:40 - INFO - __main__ -   Gradient Accumulation steps = 1
06/12/2024 02:11:40 - INFO - __main__ -   Total optimization steps = 1000




Steps:   1%|          | 7/1000 [00:11<23:52,  1.44s/it, loss=0.289, lr=5e-5]06/12/2024 02:11:52 - INFO - __main__ - Running validation...
 Generating 4 images with prompt: a hat in the crt style.
{'image_encoder', 'feature_extractor'} was not found in config. Values will be initialized to default values.
                                                                     {'sigma_max', 'timestep_type', 'sigma_min'} was not found in config. Values will be initialized to default values.
Loaded scheduler as EulerDiscreteScheduler from `scheduler` subfolder of stabilityai/stable-diffusion-xl-base-1.0.
Loaded tokenizer as CLIPTokenizer from `tokenizer` subfolder of stabilityai/stable-diffusion-xl-base-1.0.
Loaded tokenizer_2 as CLIPTokenizer from `tokenizer_2` subfolder of stabilityai/stable-diffusion-xl-base-1.0.
Loading pipeline components...: 100%|██████████| 7/7 [00:00<00:00, 59.03it/s]
{'thresholding', 'euler_at_final', 'algorithm_type', 'dynamic_thresholding_ratio', 'use_lu_lambdas', 'solver_type', 'variance_type', 'solver_order', 'lambda_min_clipped', 'lower_order_final'} was not found in config. Values will be initialized to default values.
/net/tscratch/people/plgas2000/.conda/envs/myenv2/lib/python3.9/site-packages/torch/utils/checkpoint.py:90: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
















































































































































































































































































































































Steps:  50%|█████     | 500/1000 [12:08<11:30,  1.38s/it, loss=0.388, lr=5e-5]06/12/2024 02:23:49 - INFO - accelerate.accelerator - Saving current state to ./models/dreambooth_lora_sdxl_style2_r256_2024-06-12_02-10-52/checkpoint-500
Model weights saved in ./models/dreambooth_lora_sdxl_style2_r256_2024-06-12_02-10-52/checkpoint-500/pytorch_lora_weights.safetensors
06/12/2024 02:23:52 - INFO - accelerate.checkpointing - Optimizer state saved in models/dreambooth_lora_sdxl_style2_r256_2024-06-12_02-10-52/checkpoint-500/optimizer.bin
06/12/2024 02:23:52 - INFO - accelerate.checkpointing - Scheduler state saved in models/dreambooth_lora_sdxl_style2_r256_2024-06-12_02-10-52/checkpoint-500/scheduler.bin
06/12/2024 02:23:52 - INFO - accelerate.checkpointing - Sampler state for dataloader 0 saved in models/dreambooth_lora_sdxl_style2_r256_2024-06-12_02-10-52/checkpoint-500/sampler.bin
06/12/2024 02:23:52 - INFO - accelerate.checkpointing - Gradient scaler state saved in models/dreambooth_lora_sdxl_style2_r256_2024-06-12_02-10-52/checkpoint-500/scaler.pt
06/12/2024 02:23:52 - INFO - accelerate.checkpointing - Random states saved in models/dreambooth_lora_sdxl_style2_r256_2024-06-12_02-10-52/checkpoint-500/random_states_0.pkl
06/12/2024 02:23:52 - INFO - __main__ - Saved state to ./models/dreambooth_lora_sdxl_style2_r256_2024-06-12_02-10-52/checkpoint-500













































































































































Steps:  71%|███████   | 707/1000 [16:56<06:34,  1.35s/it, loss=0.351, lr=5e-5]06/12/2024 02:28:36 - INFO - __main__ - Running validation...
 Generating 4 images with prompt: a hat in the crt style.
{'image_encoder', 'feature_extractor'} was not found in config. Values will be initialized to default values.
                                                                     {'sigma_max', 'timestep_type', 'sigma_min'} was not found in config. Values will be initialized to default values.
Loaded scheduler as EulerDiscreteScheduler from `scheduler` subfolder of stabilityai/stable-diffusion-xl-base-1.0.
Loaded tokenizer as CLIPTokenizer from `tokenizer` subfolder of stabilityai/stable-diffusion-xl-base-1.0.
Loaded tokenizer_2 as CLIPTokenizer from `tokenizer_2` subfolder of stabilityai/stable-diffusion-xl-base-1.0.
Loading pipeline components...: 100%|██████████| 7/7 [00:00<00:00, 56.05it/s]
{'thresholding', 'euler_at_final', 'algorithm_type', 'dynamic_thresholding_ratio', 'use_lu_lambdas', 'solver_type', 'variance_type', 'solver_order', 'lambda_min_clipped', 'lower_order_final'} was not found in config. Values will be initialized to default values.








































































































































































































Steps: 100%|██████████| 1000/1000 [24:20<00:00,  1.36s/it, loss=0.00238, lr=5e-5]06/12/2024 02:36:01 - INFO - accelerate.accelerator - Saving current state to ./models/dreambooth_lora_sdxl_style2_r256_2024-06-12_02-10-52/checkpoint-1000
Model weights saved in ./models/dreambooth_lora_sdxl_style2_r256_2024-06-12_02-10-52/checkpoint-1000/pytorch_lora_weights.safetensors
06/12/2024 02:36:05 - INFO - accelerate.checkpointing - Optimizer state saved in models/dreambooth_lora_sdxl_style2_r256_2024-06-12_02-10-52/checkpoint-1000/optimizer.bin
06/12/2024 02:36:05 - INFO - accelerate.checkpointing - Scheduler state saved in models/dreambooth_lora_sdxl_style2_r256_2024-06-12_02-10-52/checkpoint-1000/scheduler.bin
06/12/2024 02:36:05 - INFO - accelerate.checkpointing - Sampler state for dataloader 0 saved in models/dreambooth_lora_sdxl_style2_r256_2024-06-12_02-10-52/checkpoint-1000/sampler.bin
06/12/2024 02:36:05 - INFO - accelerate.checkpointing - Gradient scaler state saved in models/dreambooth_lora_sdxl_style2_r256_2024-06-12_02-10-52/checkpoint-1000/scaler.pt
06/12/2024 02:36:05 - INFO - accelerate.checkpointing - Random states saved in models/dreambooth_lora_sdxl_style2_r256_2024-06-12_02-10-52/checkpoint-1000/random_states_0.pkl
06/12/2024 02:36:05 - INFO - __main__ - Saved state to ./models/dreambooth_lora_sdxl_style2_r256_2024-06-12_02-10-52/checkpoint-1000

Steps: 100%|██████████| 1000/1000 [24:24<00:00,  1.36s/it, loss=0.32, lr=5e-5]   Model weights saved in ./models/dreambooth_lora_sdxl_style2_r256_2024-06-12_02-10-52/pytorch_lora_weights.safetensors
{'image_encoder', 'feature_extractor'} was not found in config. Values will be initialized to default values.
                                                                     Loaded text_encoder as CLIPTextModel from `text_encoder` subfolder of stabilityai/stable-diffusion-xl-base-1.0.
Loading pipeline components...:   0%|          | 0/7 [00:00<?, ?it/s]        {'sigma_max', 'timestep_type', 'sigma_min'} was not found in config. Values will be initialized to default values.
Loaded scheduler as EulerDiscreteScheduler from `scheduler` subfolder of stabilityai/stable-diffusion-xl-base-1.0.
Loaded text_encoder_2 as CLIPTextModelWithProjection from `text_encoder_2` subfolder of stabilityai/stable-diffusion-xl-base-1.0.
Loaded tokenizer_2 as CLIPTokenizer from `tokenizer_2` subfolder of stabilityai/stable-diffusion-xl-base-1.0.
                                                                             {'reverse_transformer_layers_per_block', 'dropout', 'attention_type'} was not found in config. Values will be initialized to default values.
Loaded unet as UNet2DConditionModel from `unet` subfolder of stabilityai/stable-diffusion-xl-base-1.0.
Loading pipeline components...: 100%|██████████| 7/7 [00:11<00:00,  1.67s/it]
{'thresholding', 'euler_at_final', 'algorithm_type', 'dynamic_thresholding_ratio', 'use_lu_lambdas', 'solver_type', 'variance_type', 'solver_order', 'lambda_min_clipped', 'lower_order_final'} was not found in config. Values will be initialized to default values.
Loading unet.
Loading text_encoder.
/net/tscratch/people/plgas2000/.conda/envs/myenv2/lib/python3.9/site-packages/diffusers/loaders/lora.py:708: FutureWarning: `_modify_text_encoder` is deprecated and will be removed in version 0.25. You are using an old version of LoRA backend. This will be deprecated in the next releases in favor of PEFT make sure to install the latest PEFT and transformers packages in the future.
  deprecate("_modify_text_encoder", "0.25", LORA_DEPRECATION_MESSAGE)
/net/tscratch/people/plgas2000/.conda/envs/myenv2/lib/python3.9/site-packages/diffusers/loaders/lora.py:679: FutureWarning: `_remove_text_encoder_monkey_patch_classmethod` is deprecated and will be removed in version 0.25. You are using an old version of LoRA backend. This will be deprecated in the next releases in favor of PEFT make sure to install the latest PEFT and transformers packages in the future.
  deprecate("_remove_text_encoder_monkey_patch_classmethod", "0.25", LORA_DEPRECATION_MESSAGE)
Loading text_encoder_2.

100%|██████████| 25/25 [00:03<00:00,  7.96it/s]
100%|██████████| 25/25 [00:03<00:00,  7.94it/s]

100%|██████████| 25/25 [00:03<00:00,  7.95it/s]


100%|██████████| 25/25 [00:03<00:00,  7.88it/s]